Observation.app=function(e){var b=$("#processDefinition-form",e),f=function(a){4194304<a.size?alert("\u6587\u4ef6\u592a\u5927"):a.type&&"application/zip"!=a.type&&"text/xml"!=a.type?alert("\u6587\u4ef6\u7c7b\u578b\u4e0d\u5bf9,\u53ea\u63a5\u53d7zip\u548cxml"):$.ajaxupload([a],{url:b.attr("action")+"/upload",onsuccess:function(){$(".reload",b).click()}})};b.on("dragover",function(a){$(this).addClass("drophover");return!1}).on("dragleave",function(a){$(this).removeClass("drophover");return!1}).on("drop",
function(a){a.preventDefault();$(this).removeClass("drophover");f(a.originalEvent.dataTransfer.files[0]);return!0});$(".btn.deploy",b).on("click",function(a){$('<input type="file"/>').insertAfter(this).hide().change(function(){f(this.files[0]);$(this).remove()}).click()});$(".trace-process",e).each(function(){var a=$(this).css("position","relative"),b=a.data("processinstanceid");a.html('<img alt="\u8ddf\u8e2a\u5de5\u4f5c\u6d41" src="'+CONTEXT_PATH+"/process/processInstance/diagram/"+b+'" style="position:absolute;">');
var d=$("img",a)[0];d.onload=function(){var g=d.width/d.naturalWidth;$.getJSON(CONTEXT_PATH+"/process/processInstance/trace/"+b,function(b){$.each(b,function(b,c){var d=$("<div/>").css({position:"absolute",left:c.x*g-1,top:c.y*g-1,width:c.width*g-2,height:c.height*g-2}).appendTo(a),e=[],h;for(h in c.vars){var f=c.vars[h];f&&e.push(h+": "+f)}d.attr("title",e.join("\n"));c.currentActiviti&&d.css({border:"2px solid red","border-radius":"12px"})})})}})};
