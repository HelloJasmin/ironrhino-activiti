Observation.app=function(c){var b=$("#processDefinition-form",c),f=function(a){4194304<a.size?alert("\u6587\u4ef6\u592a\u5927"):a.type&&"application/zip"!=a.type&&"text/xml"!=a.type?alert("\u6587\u4ef6\u7c7b\u578b\u4e0d\u5bf9,\u53ea\u63a5\u53d7zip\u548cxml"):$.ajaxupload([a],{url:b.attr("action")+"/upload",onsuccess:function(){$(".reload",b).click()}})};b.on("dragover",function(a){$(this).addClass("drophover");return!1}).on("dragleave",function(a){$(this).removeClass("drophover");return!1}).on("drop",
function(a){a.preventDefault();$(this).removeClass("drophover");f(a.originalEvent.dataTransfer.files[0]);return!0});$(".btn.deploy",b).on("click",function(a){$('<input type="file"/>').insertAfter(this).hide().change(function(){f(this.files[0]);$(this).remove()}).click()});$(".diagram",c).each(function(){var a=$(this).css("position","relative"),b=a.data("pid"),c=a.hasClass("processDefinition")?"processDefinition":"processInstance";a.html('<img alt="\u8ddf\u8e2a\u5de5\u4f5c\u6d41" src="'+CONTEXT_PATH+
"/process/"+c+"/diagram/"+b+'" style="position:absolute;">');var d=$("img",a)[0];d.onload=function(){var g=d.width/d.naturalWidth,f=0,k=0;1050==d.naturalWidth&&(f=164,k=134);$.getJSON(CONTEXT_PATH+"/process/"+c+"/trace/"+b,function(b){$.each(b,function(b,e){var c=$("<div/>").css({position:"absolute",left:(e.x-f)*g-1,top:(e.y-k)*g-1,width:e.width*g-2,height:e.height*g-2}).appendTo(a),d=[],h;for(h in e.vars){var l=e.vars[h];l&&d.push(h+": "+l)}c.attr("title",d.join("\n"));e.currentActiviti&&c.css({border:"2px solid red",
"border-radius":"12px"})})})}})};
